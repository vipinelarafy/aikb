export const runtime = 'nodejs';
import { NextRequest, NextResponse } from 'next/server';import { sign } from '@/lib/auth';
export async function POST(req:NextRequest){const b=await req.json();const {role,username,password}=b||{}; if(role==='admin'){ if(username===process.env.ADMIN_USERNAME && password===process.env.ADMIN_PASSWORD){const t=sign('admin'); const r=NextResponse.json({ok:true,role:'admin'}); r.cookies.set('auth',t,{httpOnly:true,secure:true,sameSite:'lax',path:'/'}); return r;} return NextResponse.json({ok:false,error:'Invalid credentials'},{status:401});} if(role==='customer'){ if(username===process.env.CUSTOMER_USERNAME && password===process.env.CUSTOMER_PASSWORD){const t=sign('customer'); const r=NextResponse.json({ok:true,role:'customer'}); r.cookies.set('auth',t,{httpOnly:true,secure:true,sameSite:'lax',path:'/'}); return r;} return NextResponse.json({ok:false,error:'Invalid credentials'},{status:401});} return NextResponse.json({ok:false,error:'Invalid role'},{status:400});}
